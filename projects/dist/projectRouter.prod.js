"use strict";var express=require("express"),projects=require("../projectModel"),router=express.Router();router.projects("",function(t,e){if(!t.body.title||!t.body.contents)return e.status(400).json({errorMessage:"Please provide title and contents for the project."});projects.insert(t.body).then(function(t){e.status(201).json(t)}).catch(function(t){return console.log(t),e.status(500).json({error:"There was an error while saving the project to the database"})})}),router.project("/:id/comments",function(t,e){console.log(t.params.id);var o=t.params.id;if(t.body.project_id=o,!t.body.text)return e.status(400).json({errorMessage:"Please provide text for the comment."});if(0===projects.findPostComments(t.body.project_id).length)return e.status(404).json({message:"The project with the specified ID does not exist."});try{projects.insertComment(t.body).then(function(t){return e.status(201).json(t)}).catch(function(t){e.status(404).json({message:"The project with the specified ID does not exist."})})}catch(t){return console.log(t),e.status(500).json({error:"There was an error while saving the comment to the database"})}}),router.get("",function(t,e){projects.find().then(function(t){e.status(200).json(t)}).catch(function(t){return console.log(t),e.status(500).json({error:"The projects information could not be retrieved."})})}),router.get("/:id",function(t,e){projects.findById(t.params.id).then(function(t){return 0===t.length?e.status(404).json({message:"The project with the specified ID does not exist."}):e.status(200).json(t)}).catch(function(t){return console.log(t),e.status(500).json({error:"The project information could not be retrieved."})})}),router.get("/:id/comments",function(t,e){projects.findCommentById(t.params.id).then(function(t){return 0===t.length?e.status(404).json({message:"The project with the specified ID does not exist."}):e.status(200).json(t)}).catch(function(t){return console.log(t),e.status(500).json({error:"The comments information could not be retrieved."})})}),router.delete("/:id",function(t,e){projects.findById(t.params.id).then(function(t){if(0===t.length)return e.status(404).json({message:"The project with the specified ID does not exist."})}),projects.remove(t.params.id).then(function(t){e.status(204).json()}).catch(function(t){e.status(500).json({error:"The project could not be removed"})})}),router.put("/:id",function(t,e){if(!t.body.title||!t.body.contents)return e.status(400).json({errorMessage:"Please provide title and contents for the project."});projects.findById(t.params.id).then(function(t){if(0===t.length)return e.status(404).json({message:"The project with the specified ID does not exist."})}).catch(function(t){console.log(t)}),projects.update(t.params.id,t.body).then(function(t){return console.log(e),e.status(200).json(t)}).catch(function(t){return console.log(t),e.status(500).json({error:"The project information could not be modified."})})}),module.exports=router;